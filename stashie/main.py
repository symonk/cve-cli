import typer
from click import Choice

from ._constants import DEFAULT_TOKEN_FULLPATH

app = typer.Typer()


@app.command()
def menu(token_path: str = typer.Option(str(DEFAULT_TOKEN_FULLPATH))):
    """
    Entry point into the stashie command line.

    :param token_path: A file path where the bitbucket token is stored on the first line"

    :return: None
    """
    typer.secho("Stashie has been successfully loaded...", fg=typer.colors.GREEN)
    while True:
        selection = _menu()
        if selection == 2:
            raise typer.Exit()


def _menu() -> int:
    typer.secho("Please select an option")
    selection = typer.prompt(
        """
        What would you like to do?
            >>> (1) - Read all open pull requests
            >>> (2) - Exit Stashie """,
        type=Choice(set(map(str, range(1, 3)))),
        show_choices=False,
    )
    return int(selection)
